#1 Fix runtime errors.
#2 Add hooks.
#3 Unit tests.
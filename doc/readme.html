<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.38.2">
    <meta name="project" content="elector v0.3.1">


    <title>Getting Started â€” elector v0.3.1</title>

    <link rel="stylesheet" href="dist/html-erlang-DQDXQC7W.css" />

    <script defer src="dist/sidebar_items-2816BE4E.js"></script>
    <script defer src="docs_config.js"></script>
    <script defer src="dist/html-DPJLHKSM.js"></script>

  </head>
  <body>
    <script>(()=>{var t="ex_doc:settings",e="dark";var o="dark",s="light";var E="sidebar_state",n="closed";var r="sidebar_width";var a="sidebar-open";var i=new URLSearchParams(window.location.search),S=i.get("theme")||JSON.parse(localStorage.getItem(t)||"{}").theme;(S===o||S!==s&&window.matchMedia("(prefers-color-scheme: dark)").matches)&&document.body.classList.add(e);var d=sessionStorage.getItem(E),A=d!==n&&!window.matchMedia(`screen and (max-width: ${768}px)`).matches;document.body.classList.toggle(a,A);var c=sessionStorage.getItem(r);c&&document.body.style.setProperty("--sidebarWidth",`${c}px`);var p=/(Macintosh|iPhone|iPad|iPod)/.test(window.navigator.userAgent);document.documentElement.classList.toggle("apple-os",p);})();
</script>

<div class="body-wrapper">

<button id="sidebar-menu" class="sidebar-button sidebar-toggle" aria-label="toggle sidebar" aria-controls="sidebar">
  <i class="ri-menu-line ri-lg" title="Collapse/expand sidebar"></i>
</button>

<nav id="sidebar" class="sidebar">

  <div class="sidebar-header">
    <div class="sidebar-projectInfo">

      <div>
        <a href="https://github.com/alfetahe/elector" class="sidebar-projectName" translate="no">
elector
        </a>
        <div class="sidebar-projectVersion" translate="no">
          v0.3.1
        </div>
      </div>
    </div>
    <ul id="sidebar-list-nav" class="sidebar-list-nav" role="tablist" data-extras=""></ul>
  </div>
</nav>

<output role="status" id="toast"></output>

<main class="content page-extra" id="main" data-type="extras">
  <div id="content" class="content-inner">
    <div class="top-search">
      <div class="search-settings">
        <form class="search-bar" action="search.html">
          <label class="search-label">
            <span class="sr-only">Search documentation of elector</span>
            <input name="q" type="text" class="search-input" placeholder="Press / to search" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" />
          </label>
          <button type="submit" class="search-button" aria-label="Submit Search" tabindex="-1">
            <i class="ri-search-2-line ri-lg" aria-hidden="true"></i>
          </button>
          <button type="button" tabindex="-1" class="search-close-button" aria-hidden="true">
            <i class="ri-close-line ri-lg" title="Cancel search"></i>
          </button>
        </form>
        <div class="autocomplete">
        </div>
        <button class="icon-settings display-settings">
          <i class="ri-settings-3-line"></i>
          <span class="sr-only">Settings</span>
        </button>
      </div>
    </div>

<div id="top-content">
  <div class="heading-with-actions top-heading">
    <h1>Elector</h1>


      <a href="https://github.com/alfetahe/elector/blob/v0.3.1/README.md#L1" title="View Source" class="icon-action" rel="help">
        <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        <span class="sr-only">View Source</span>
      </a>

  </div>


<p><img src="https://github.com/alfetahe/elector/actions/workflows/erlang.yml/badge.svg" alt="example workflow"/></p><h2 id="description" class="section-heading"><a href="#description" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Description</span></h2><p>Elector is an Erlang application that automatically detects all nodes inside the distributed Erlang cluster and chooses the leader node.
The elections are started automatically when the Elector application is started or when a node joins or leaves the cluster.
Elector also allows you to run pre- and post-election hooks that will be triggered when the election process is started and finished.</p><p>The default election strategy is to choose the node with the highest uptime.</p><h2 id="features" class="section-heading"><a href="#features" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Features</span></h2><ul><li>Automatic election process on startup or when node joins/leaves the cluster</li><li>Ability to configure pre and post election hooks that will be called before and after the election process. <strong>These hooks must return within 1 second to avoid timeouts</strong>.</li><li>Provides 4 built in election strategies (time based) and allows you to define your own strategy implementation (See <code class="inline">elector_strategy_behaviour</code> module for reference)</li><li>Provides quorum option to detect split brain scenarios</li><li>Provides option to define the election delay in milliseconds before the election process is started automatically and queue the election calls</li></ul><h2 id="configuration" class="section-heading"><a href="#configuration" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Configuration</span></h2><p>Elector supports the following configurations:</p><ul><li><p><code class="inline">election_delay</code> - The delay in milliseconds before the new election starts. This value is used when automatic election is triggered either by node join/leave or startup. Default value is 1 second (1000).</p></li><li><p><code class="inline">strategy_module</code> - The module that is used for the election strategy implementation. Available options are: <code class="inline">elector_rt_high_strategy</code> and <code class="inline">elector_rt_low_strategy</code>. Feel free to write your own strategy module that implements the <code class="inline">elector_strategy_behaviour</code> module. Default value is <code class="inline">elector_rt_high_strategy</code> which chooses the node with the highest runtime.</p></li><li><p><code class="inline">pre_election_hooks</code> - A list of hooks/function calls that will be triggered exactly before the node is starting the election. Expects a list of tuples with the following format: <code class="inline">{Module, Function, Args}</code>. Default value is <code class="inline">[]</code>.</p></li><li><p><code class="inline">post_election_hooks</code> - A list of hooks/function calls that will be triggered exactly after the election process. Expects a list of tuples with the following format: <code class="inline">{Module, Function, Args}</code>. Default value is <code class="inline">[]</code>.</p></li><li><p><code class="inline">quorum_size</code> - The number of nodes (including the local node) that should be available in the cluster before the election process is started. Do not set it to <code class="inline">0</code> as it will disable the election process, leave empty or <code class="inline">1</code> if you want to run the election process even if there are no other nodes in the cluster. Default value is <code class="inline">1</code>.</p></li><li><p><code class="inline">candidate_node</code> - Boolean indicating if this node should be a candidate for the leader election. Default value is <code class="inline">true</code>.</p></li><li><p><code class="inline">hooks_execution</code> - Atom indicating if the pre and post election hooks should be executed on the node starting the election process or on all nodes. The election process will be started automatically by the global commission process. The node who starts the commission process is not known and can be any node in the cluster. Available values are: <code class="inline">local</code> and <code class="inline">global</code>. Default value is <code class="inline">global</code>.</p></li><li><p><code class="inline">automatic_elections</code> - Boolean indicating if the automatic election process should be started when node joins or leaves the cluster. Default value is <code class="inline">true</code>.</p></li></ul><p>Keep in mind to use the same configuration for all nodes in the cluster!</p><h2 id="guides" class="section-heading"><a href="#guides" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Guides</span></h2><h3 id="installation-for-elixir-application" class="section-heading"><a href="#installation-for-elixir-application" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Installation for Elixir application</span></h3><ol><li>Add <code class="inline">{:elector, &quot;~&gt; 0.3.1&quot;}</code> under the deps in the <code class="inline">mix.exs</code> file:</li></ol><pre><code class="makeup elixir" translate="no"><span class="kd">defp</span><span class="w"> </span><span class="nf">deps</span><span class="w"> </span><span class="k" data-group-id="9534511247-1">do</span><span class="w">
    </span><span class="p" data-group-id="9534511247-2">[</span><span class="w">
        </span><span class="p" data-group-id="9534511247-3">{</span><span class="ss">:elector</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;~&gt; 0.3.1&quot;</span><span class="p" data-group-id="9534511247-3">}</span><span class="w">
    </span><span class="p" data-group-id="9534511247-2">]</span><span class="w">
</span><span class="k" data-group-id="9534511247-1">end</span></code></pre><ol start="2"><li>Add <code class="inline">elector</code> under the extra_applications in the <code class="inline">mix.exs</code> file:</li></ol><pre><code class="makeup elixir" translate="no"><span class="kd">def</span><span class="w"> </span><span class="nf">application</span><span class="w"> </span><span class="k" data-group-id="3467623184-1">do</span><span class="w">
    </span><span class="p" data-group-id="3467623184-2">[</span><span class="w">
        </span><span class="ss">extra_applications</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="3467623184-3">[</span><span class="ss">:elector</span><span class="p" data-group-id="3467623184-3">]</span><span class="p">,</span><span class="w">
        </span><span class="ss">mod</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="3467623184-4">{</span><span class="nc">MyApp</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3467623184-5">[</span><span class="p" data-group-id="3467623184-5">]</span><span class="p" data-group-id="3467623184-4">}</span><span class="w">
    </span><span class="p" data-group-id="3467623184-2">]</span><span class="w">
</span><span class="k" data-group-id="3467623184-1">end</span></code></pre><h3 id="installation-for-erlang-application" class="section-heading"><a href="#installation-for-erlang-application" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Installation for Erlang application</span></h3><ol><li>Add <code class="inline">elector</code> to the deps in the <code class="inline">rebar.config</code> file:</li></ol><pre><code class="makeup erlang" translate="no"><span class="p" data-group-id="8768674770-1">{</span><span class="ss">deps</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="8768674770-2">[</span><span class="p" data-group-id="8768674770-3">{</span><span class="s">&quot;elector&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;0.3.1&quot;</span><span class="p" data-group-id="8768674770-3">}</span><span class="p" data-group-id="8768674770-2">]</span><span class="p" data-group-id="8768674770-1">}</span><span class="p">.</span></code></pre><ol start="2"><li>Add <code class="inline">elector</code> to the <code class="inline">applications</code> list in the <code class="inline">myapp.app.src</code> file:</li></ol><pre><code class="makeup erlang" translate="no"><span class="p" data-group-id="4252179369-1">{</span><span class="ss">applications</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="4252179369-2">[</span><span class="ss">elector</span><span class="p" data-group-id="4252179369-2">]</span><span class="p" data-group-id="4252179369-1">}</span><span class="p">.</span></code></pre><h2 id="examples" class="section-heading"><a href="#examples" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Examples</span></h2><h3 id="start-election-manually" class="section-heading"><a href="#start-election-manually" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Start election manually</span></h3><h4>Elixir</h4><pre><code class="makeup elixir" translate="no"><span class="o">&gt;</span><span class="w"> </span><span class="kn">alias</span><span class="w"> </span><span class="ss">:elector</span><span class="p">,</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="nc">Elector</span><span class="w">
</span><span class="o">&gt;</span><span class="w"> </span><span class="nc">Elector</span><span class="o">.</span><span class="n">elect_sync</span><span class="p" data-group-id="3949733709-1">(</span><span class="p" data-group-id="3949733709-1">)</span><span class="w"> </span><span class="c1"># Start election synchronously</span><span class="w">
</span><span class="p" data-group-id="3949733709-2">{</span><span class="ss">:ok</span><span class="p">,</span><span class="w"> </span><span class="ss">:election_finished</span><span class="p" data-group-id="3949733709-2">}</span><span class="w">
</span><span class="o">&gt;</span><span class="w"> </span><span class="nc">Elector</span><span class="o">.</span><span class="n">elect</span><span class="p" data-group-id="3949733709-3">(</span><span class="p" data-group-id="3949733709-3">)</span><span class="w"> </span><span class="c1"># Start election asynchronously</span><span class="w">
</span><span class="p" data-group-id="3949733709-4">{</span><span class="ss">:ok</span><span class="p">,</span><span class="w"> </span><span class="ss">:election_started</span><span class="p" data-group-id="3949733709-4">}</span></code></pre><h4>Erlang</h4><pre><code class="makeup erlang" translate="no"><span class="gp unselectable">&gt; </span><span class="nc">elector</span><span class="p">:</span><span class="nf">elect_sync</span><span class="p" data-group-id="4882967018-1">(</span><span class="p" data-group-id="4882967018-1">)</span><span class="p">.</span><span class="w"> </span><span class="c1">% Start election synchronously</span><span class="w">
</span><span class="p" data-group-id="4882967018-2">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="ss">election_finished</span><span class="p" data-group-id="4882967018-2">}</span><span class="gp unselectable">
&gt; </span><span class="nc">elector</span><span class="p">:</span><span class="nf">elect</span><span class="p" data-group-id="4882967018-3">(</span><span class="p" data-group-id="4882967018-3">)</span><span class="p">.</span><span class="w"> </span><span class="c1">% Start election asynchronously</span><span class="w">
</span><span class="p" data-group-id="4882967018-4">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="ss">election_started</span><span class="p" data-group-id="4882967018-4">}</span></code></pre><h3 id="get-current-leader" class="section-heading"><a href="#get-current-leader" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Get current leader</span></h3><h4>Elixir</h4><pre><code class="makeup elixir" translate="no"><span class="o">&gt;</span><span class="w"> </span><span class="kn">alias</span><span class="w"> </span><span class="ss">:elector</span><span class="p">,</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="nc">Elector</span><span class="w">
</span><span class="o">&gt;</span><span class="w"> </span><span class="nc">Elector</span><span class="o">.</span><span class="n">get_leader</span><span class="p" data-group-id="7619762443-1">(</span><span class="p" data-group-id="7619762443-1">)</span><span class="w">
</span><span class="p" data-group-id="7619762443-2">{</span><span class="ss">:ok</span><span class="p">,</span><span class="w"> </span><span class="ss">:example_node</span><span class="p" data-group-id="7619762443-2">}</span></code></pre><h4>Erlang</h4><pre><code class="makeup erlang" translate="no"><span class="gp unselectable">&gt; </span><span class="nc">elector</span><span class="p">:</span><span class="nf">get_leader</span><span class="p" data-group-id="3171902757-1">(</span><span class="p" data-group-id="3171902757-1">)</span><span class="p">.</span><span class="w">
</span><span class="p" data-group-id="3171902757-2">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="ss">example_node</span><span class="p" data-group-id="3171902757-2">}</span></code></pre><p>See the <code class="inline">elector</code> module for more.</p><p><a href="https://hexdocs.pm/elector/">https://hexdocs.pm/elector/</a></p><h2 id="high-level-overview" class="section-heading"><a href="#high-level-overview" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">High level overview</span></h2><p>Elector is a distributed application that utilizes the Erlang global module to spawn a singleton process named
<code class="inline">elector_commission</code>. The commission process is responsible for starting the election process and keeping track of the nodes in the cluster.
The election process is started by the commission process, which calls the <code class="inline">elect/1</code> function from the strategy module.
This function gathers the necessary information from the cluster and decides which node should become the leader.</p><p>Each node spawns the following local processes:</p><ul><li><code class="inline">elector_overviewer</code> process is responsible for starting the commission and monitor it across the cluster.</li><li><code class="inline">elector_candidate</code> process holding the candidate information that describes if the node is a candidate for the leader election.</li><li><code class="inline">elector_state</code> process holding the selected leader information.</li></ul><p>All processes are supervised by the <code class="inline">elector_sup</code> supervisor.</p><h2 id="setup-elector-locally" class="section-heading"><a href="#setup-elector-locally" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Setup Elector locally</span></h2><h3 id="setup-the-elector-locally-and-run-the-application" class="section-heading"><a href="#setup-the-elector-locally-and-run-the-application" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Setup the elector locally and run the application:</span></h3><ul><li><code class="inline">docker-compose up -d</code></li><li><code class="inline">docker exec -it elector_elector_1 sh</code></li><li><code class="inline">rebar3 compile</code></li><li><code class="inline">erl -sname local -setcookie cookievalue -pa ./_build/default/lib/elector/ebin -eval &quot;application:start(elector)&quot;</code></li></ul><h3 id="run-tests" class="section-heading"><a href="#run-tests" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Run tests:</span></h3><ul><li><code class="inline">rebar3 compile &amp;&amp; ct_run -dir test -logdir test_logs -pa ./_build/default/lib/elector/ebin -setcookie cookievalue</code></li></ul><h3 id="generate-documentation" class="section-heading"><a href="#generate-documentation" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Generate documentation:</span></h3><ul><li><code class="inline">rebar3 ex_doc</code></li></ul>

</div>

<div class="bottom-actions" id="bottom-actions">
  <div class="bottom-actions-item">

  </div>
  <div class="bottom-actions-item">

      <a href="changelog.html" class="bottom-actions-button" rel="next">
        <span class="subheader">
          Next Page â†’
        </span>
        <span class="title">
Changelog
        </span>
      </a>

  </div>
</div>
    <footer class="footer">
      <p>

          <span class="line">
            <a href="https://hex.pm/packages/elector/0.3.1" class="footer-hex-package">Hex Package</a>

            <a href="https://preview.hex.pm/preview/elector/0.3.1">Hex Preview</a>

              (<a href="https://preview.hex.pm/preview/elector/0.3.1/show/README.md">current file</a>)

          </span>

        <span class="line">
          <button class="a-main footer-button display-quick-switch" title="Search HexDocs packages">
            Search HexDocs
          </button>

            <a href="elector.epub" title="ePub version">
              Download ePub version
            </a>

        </span>
      </p>

      <p class="built-using">
        Built using
        <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener" translate="no">ExDoc</a> (v0.38.2) for the

          <a href="https://erlang.org" title="Erlang" target="_blank" translate="no">Erlang programming language</a>

      </p>

    </footer>
  </div>
</main>
</div>

  </body>
</html>
